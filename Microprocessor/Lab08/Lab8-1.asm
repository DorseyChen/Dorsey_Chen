	ORG	0000H
	JMP	START
	ORG	0050H
START:					;事前設定	
	MOV	DPTR,#TABLE		;載入表格
	MOV	R5,#40			;R5紀錄delay	
	CALL	DELAY

	MOV	A,#00111011B	;八位元存取、二列、5x7點矩陣
	CALL	COMMAND
	MOV	R5,#2
	CALL	DELAY

	MOV	A,#00001111B	;顯示器ON游標閃爍
	CALL	COMMAND
	MOV	R5,#2
	CALL	DELAY

	MOV	A,#00000001B 	;清除螢幕
	CALL	COMMAND
	MOV	R5,#40
	CALL	DELAY

	MOV	A,#10000000B	;設定DD RAM位置為0
	CALL	COMMAND
	MOV	R5,#2
	CALL	DELAY
;----------------------
AGAIN:					 ;顯示
	CLR	A
	MOVC	A,@A+DPTR
	INC	DPTR
	JZ AGAIN1
	CALL	SENDDATA
	JMP	AGAIN
AGAIN1:
	JMP	START			 ;顯示完回到start 	
;----------------------
COMMAND:
	MOV	P0,A
	MOV	P1,#00000100B	 ;E_R/W_RS 100 ->INSTRUCTION REGISTER
	MOV	P1,#00000000B  	 ;E_R/W_RS 000 ->DISABLE
	MOV	R5,#2
	CALL	DELAY
	RET
;----------------------
SENDDATA:
	MOV	P0,A
	MOV	P1,#00000101B	 ;E_R/W_RS 101 ->WRITE TO DD-RAM
	MOV	P1,#00000001B	 ;E_R/W_RS 001 ->DISABLE
	MOV	P1,#00000000B	 ;E_R/W_RS 000 ->DISABLE
	MOV	R5,#2		    
	CALL	DELAY
	RET
;----------------------
DELAY:
	MOV	R6,#240
DELAY1:
	MOV	R7,#255
DELAY2:
	DJNZ	R7,DELAY2
	DJNZ	R6,DELAY1
	DJNZ	R5,DELAY
	RET
;----------------------
TABLE:
	DB		"0610837",0
END