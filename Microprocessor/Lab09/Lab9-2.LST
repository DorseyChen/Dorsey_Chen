A51 MACRO ASSEMBLER  LAB9_2                                                               12/11/2018 13:45:30 PAGE     1


MACRO ASSEMBLER A51 V8.01
OBJECT MODULE PLACED IN Lab9-2.OBJ
ASSEMBLER INVOKED BY: C:\Keil\C51\BIN\A51.EXE Lab9-2.asm SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

0000                   1             ORG     00H
0000 8003              2             JMP     INITIAL
0003                   3             ORG     03H
0003 800B              4             JMP     INTERRUPT
0005                   5     INITIAL:
0005 D288              6             SETB    IT0                ;外部中斷P3.2設為edge trigger        
0007 75A881            7             MOV             IE,#10000001B      ;interrupt enable EA=1,EX0=1         
000A 7900              8             MOV             R1,#0               
000C 7C00              9             MOV             R4,#0
000E                  10     WAIT:
000E 80FE             11             JMP             WAIT                 ;一個無限循環的空loop      
0010                  12     INTERRUPT:
0010 1134             13             CALL    TABL
0012                  14     NEXT:
0012 7848             15             MOV             R0,#72      
0014 7B18             16             MOV             R3,#24                  ;顯示24次
0016                  17     NEXT_COLUMN:                    ;一次顯示3*8bit的燈     
0016 112F             18             CALL    READ_BYTE               
0018 F590             19             MOV             P1,A
001A 112F             20             CALL    READ_BYTE
001C F5A0             21             MOV             P2,A
001E 112F             22             CALL    READ_BYTE
0020 F580             23             MOV             P0,A
0022 31C5             24             CALL    DELAY             ;短暫的delay視覺暫留          
0024 DBF0             25             DJNZ    R3,NEXT_COLUMN
0026 BC3204           26             CJNE    R4,#50,COUNT       ;如果全部顯示完則歸零                            
0029 09               27             INC             R1
002A 7C00             28             MOV             R4,#0
002C 32               29             RETI
002D                  30     COUNT:
002D 0C               31             INC             R4
002E 32               32             RETI    
002F                  33     READ_BYTE:
002F 18               34             DEC             R0                    ;讀取table用
0030 E8               35             MOV             A,R0                    
0031 93               36             MOVC    A,@A+DPTR
0032 F4               37             CPL             A
0033 22               38             RET
0034                  39     TABL:
0034 B90004           40             CJNE    R1,#0,J1
0037 90005D           41             MOV             DPTR,#TABLE0
003A 22               42             RET     
003B                  43     J1:
003B B90A04           44             CJNE    R1,#10,J2          ;如果中斷次數＝10次
003E 9000A5           45             MOV     DPTR,#TABLE1    
0041 22               46             RET
0042                  47     J2:
0042 B90F04           48             CJNE    R1,#15,J3          ;邏輯同上    
0045 9000ED           49             MOV     DPTR,#TABLE2   
0048 22               50             RET
0049                  51     J3:
0049 B91404           52             CJNE    R1,#20,J4          ;邏輯同上    
004C 900135           53             MOV     DPTR,#TABLE3
004F 22               54             RET
0050                  55     J4:
0050 B91904           56             CJNE    R1,#25,J5          ;邏輯同上    
0053 90017D           57             MOV     DPTR,#TABLE4
0056 22               58             RET
A51 MACRO ASSEMBLER  LAB9_2                                                               12/11/2018 13:45:30 PAGE     2

0057                  59     J5:
0057 7900             60             MOV             R1,#0        ;邏輯同上  
0059 90005D           61             MOV     DPTR,#TABLE0     
005C 22               62             RET
                      63     
005D                  64     TABLE0:
005D 000000           65                     DB      0000000B,00000000B,00000000B
0060 01FFE0           66             DB      0000001B,11111111B,11100000B
0063 07FFF8           67             DB      0000111B,11111111B,11111000B
0066 0FFFFC           68             DB      0001111B,11111111B,11111100B
0069 0F003C           69             DB      0001111B,00000000B,00111100B
006C 0C000C           70             DB      0001100B,00000000B,00001100B
006F 0C000C           71             DB      0001100B,00000000B,00001100B
0072 0F807C           72             DB      0001111B,10000000B,01111100B
0075 0FFFFC           73             DB      0001111B,11111111B,11111100B
0078 07FFF8           74             DB      0000111B,11111111B,11111000B
007B 00FFC0           75             DB      0000000B,11111111B,11000000B
007E 000000           76             DB      0000000B,00000000B,00000000B
0081 000000           77             DB      0000000B,00000000B,00000000B
0084 000000           78             DB      0000000B,00000000B,00000000B
0087 000000           79             DB      0000000B,00000000B,00000000B
008A 000000           80             DB      0000000B,00000000B,00000000B
008D 000000           81             DB      0000000B,00000000B,00000000B
0090 000000           82             DB      0000000B,00000000B,00000000B
0093 000000           83             DB      0000000B,00000000B,00000000B
0096 000000           84             DB      0000000B,00000000B,00000000B
0099 000000           85             DB      0000000B,00000000B,00000000B
009C 000000           86             DB      0000000B,00000000B,00000000B
009F 000000           87             DB      0000000B,00000000B,00000000B
00A2 000000           88             DB      0000000B,00000000B,00000000B
00A5                  89     TABLE1:
00A5 01FC60           90             DB      0000001B,11111100B,01100000B
00A8 07FE78           91                     DB      0000111B,11111110B,01111000B
00AB 0FFF0C           92                     DB      0001111B,11111111B,00001100B
00AE 0F070C           93                     DB      0001111B,00000111B,00001100B
00B1 0C030E           94                     DB      0001100B,00000011B,00001110B
00B4 0C030E           95                     DB      0001100B,00000011B,00001110B
00B7 0C030E           96                     DB      0001100B,00000011B,00001110B
00BA 0E073C           97                     DB      0001110B,00000111B,00111100B
00BD 0FFFFC           98                     DB      0001111B,11111111B,11111100B
00C0 07FFE0           99                     DB      0000111B,11111111B,11100000B
00C3 01FFC0          100                     DB      0000001B,11111111B,11000000B
00C6 000000          101             DB      0000000B,00000000B,00000000B
00C9 000000          102             DB      0000000B,00000000B,00000000B
00CC 000000          103             DB      0000000B,00000000B,00000000B
00CF 000000          104             DB      0000000B,00000000B,00000000B
00D2 000000          105             DB      0000000B,00000000B,00000000B
00D5 000000          106             DB      0000000B,00000000B,00000000B
00D8 000000          107             DB      0000000B,00000000B,00000000B
00DB 000000          108             DB      0000000B,00000000B,00000000B
00DE 000000          109             DB      0000000B,00000000B,00000000B
00E1 000000          110             DB      0000000B,00000000B,00000000B
00E4 000000          111             DB      0000000B,00000000B,00000000B
00E7 000000          112             DB      0000000B,00000000B,00000000B
00EA 000000          113             DB      0000000B,00000000B,00000000B
00ED                 114     TABLE2:
00ED 080000          115             DB      0001000B,00000000B,00000000B
00F0 080000          116             DB      0001000B,00000000B,00000000B
00F3 0FFFFC          117                     DB      0001111B,11111111B,11111100B
00F6 0FFFFC          118                     DB      0001111B,11111111B,11111100B
00F9 0FFFF8          119                     DB      0001111B,11111111B,11111000B
00FC 080008          120                     DB      0001000B,00000000B,00001000B
00FF 080008          121                     DB      0001000B,00000000B,00001000B
0102 000000          122                     DB      0000000B,00000000B,00000000B
0105 000000          123                     DB      0000000B,00000000B,00000000B
0108 000000          124             DB      0000000B,00000000B,00000000B
A51 MACRO ASSEMBLER  LAB9_2                                                               12/11/2018 13:45:30 PAGE     3

010B 000000          125             DB      0000000B,00000000B,00000000B
010E 000000          126             DB      0000000B,00000000B,00000000B
0111 000000          127             DB      0000000B,00000000B,00000000B
0114 000000          128             DB      0000000B,00000000B,00000000B
0117 000000          129             DB      0000000B,00000000B,00000000B
011A 000000          130             DB      0000000B,00000000B,00000000B
011D 000000          131             DB      0000000B,00000000B,00000000B
0120 000000          132             DB      0000000B,00000000B,00000000B
0123 000000          133             DB      0000000B,00000000B,00000000B
0126 000000          134             DB      0000000B,00000000B,00000000B
0129 000000          135             DB      0000000B,00000000B,00000000B
012C 000000          136             DB      0000000B,00000000B,00000000B
012F 000000          137             DB      0000000B,00000000B,00000000B
0132 000000          138             DB      0000000B,00000000B,00000000B
0135                 139     TABLE3:
0135 000000          140                     DB      0000000B,00000000B,00000000B
0138 01FFE0          141             DB      0000001B,11111111B,11100000B
013B 07FFF8          142             DB      0000111B,11111111B,11111000B
013E 0FFFFC          143             DB      0001111B,11111111B,11111100B
0141 0F003C          144             DB      0001111B,00000000B,00111100B
0144 080004          145             DB      0001000B,00000000B,00000100B
0147 0C000C          146             DB      0001100B,00000000B,00001100B
014A 0F807C          147             DB      0001111B,10000000B,01111100B
014D 0FFFFC          148             DB      0001111B,11111111B,11111100B
0150 07FFF8          149             DB      0000111B,11111111B,11111000B
0153 00FFC0          150             DB      0000000B,11111111B,11000000B
0156 000000          151             DB      0000000B,00000000B,00000000B
0159 000000          152             DB      0000000B,00000000B,00000000B
015C 000000          153             DB      0000000B,00000000B,00000000B
015F 000000          154             DB      0000000B,00000000B,00000000B
0162 000000          155             DB      0000000B,00000000B,00000000B
0165 000000          156             DB      0000000B,00000000B,00000000B
0168 000000          157             DB      0000000B,00000000B,00000000B
016B 000000          158             DB      0000000B,00000000B,00000000B
016E 000000          159             DB      0000000B,00000000B,00000000B
0171 000000          160             DB      0000000B,00000000B,00000000B
0174 000000          161             DB      0000000B,00000000B,00000000B
0177 000000          162             DB      0000000B,00000000B,00000000B
017A 000000          163             DB      0000000B,00000000B,00000000B
017D                 164     TABLE4:
017D 000000          165             DB      0000000B,00000000B,00000000B
0180 03E370          166             DB      0000011B,11100011B,01110000B
0183 07F7F8          167             DB      0000111B,11110111B,11111000B
0186 0FFFFC          168             DB      0001111B,11111111B,11111100B
0189 088C4C          169             DB      0001000B,10001100B,01001100B
018C 080C04          170             DB      0001000B,00001100B,00000100B
018F 080C04          171             DB      0001000B,00001100B,00000100B
0192 0C0F9C          172             DB      0001100B,00001111B,10011100B
0195 0FFFFC          173             DB      0001111B,11111111B,11111100B
0198 07FBF8          174             DB      0000111B,11111011B,11111000B
019B 03F3F0          175             DB      0000011B,11110011B,11110000B
019E 000000          176             DB      0000000B,00000000B,00000000B
01A1 000000          177             DB      0000000B,00000000B,00000000B
01A4 000000          178             DB      0000000B,00000000B,00000000B
01A7 000000          179             DB      0000000B,00000000B,00000000B
01AA 000000          180             DB      0000000B,00000000B,00000000B
01AD 000000          181             DB      0000000B,00000000B,00000000B
01B0 000000          182             DB      0000000B,00000000B,00000000B
01B3 000000          183             DB      0000000B,00000000B,00000000B
01B6 000000          184             DB      0000000B,00000000B,00000000B
01B9 000000          185             DB      0000000B,00000000B,00000000B
01BC 000000          186             DB      0000000B,00000000B,00000000B
01BF 000000          187             DB      0000000B,00000000B,00000000B
01C2 000000          188             DB      0000000B,00000000B,00000000B
                     189       
                     190     
A51 MACRO ASSEMBLER  LAB9_2                                                               12/11/2018 13:45:30 PAGE     4

01C5                 191     DELAY:
01C5 7E46            192             MOV             R6,#70
01C7                 193     DELAY1:
01C7 7F46            194             MOV             R7,#70
01C9                 195     DELAY2:
01C9 DFFE            196             DJNZ    R7,DELAY2
01CB DEFA            197             DJNZ    R6,DELAY1
01CD 22              198             RET
                     199     
                     200     END
A51 MACRO ASSEMBLER  LAB9_2                                                               12/11/2018 13:45:30 PAGE     5

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

COUNT. . . . . . .  C ADDR   002DH   A   
DELAY. . . . . . .  C ADDR   01C5H   A   
DELAY1 . . . . . .  C ADDR   01C7H   A   
DELAY2 . . . . . .  C ADDR   01C9H   A   
IE . . . . . . . .  D ADDR   00A8H   A   
INITIAL. . . . . .  C ADDR   0005H   A   
INTERRUPT. . . . .  C ADDR   0010H   A   
IT0. . . . . . . .  B ADDR   0088H.0 A   
J1 . . . . . . . .  C ADDR   003BH   A   
J2 . . . . . . . .  C ADDR   0042H   A   
J3 . . . . . . . .  C ADDR   0049H   A   
J4 . . . . . . . .  C ADDR   0050H   A   
J5 . . . . . . . .  C ADDR   0057H   A   
NEXT . . . . . . .  C ADDR   0012H   A   
NEXT_COLUMN. . . .  C ADDR   0016H   A   
P0 . . . . . . . .  D ADDR   0080H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
READ_BYTE. . . . .  C ADDR   002FH   A   
TABL . . . . . . .  C ADDR   0034H   A   
TABLE0 . . . . . .  C ADDR   005DH   A   
TABLE1 . . . . . .  C ADDR   00A5H   A   
TABLE2 . . . . . .  C ADDR   00EDH   A   
TABLE3 . . . . . .  C ADDR   0135H   A   
TABLE4 . . . . . .  C ADDR   017DH   A   
WAIT . . . . . . .  C ADDR   000EH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
